{"ast":null,"code":"var _jsxFileName = \"/Users/samuelvirgo/Documents/development/ditto/covid19_tracker_app/src/chart/chart.js\";\nimport React from 'react';\nimport * as d3 from 'd3';\nimport { select as d3Select } from 'd3-selection';\nimport uuidv1 from \"uuid\";\nimport Axis from './axis.js';\nimport Grid from './grid.js';\nimport LineChart from './line.js';\nimport ImageChart from './image.js';\n\nclass Chart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      zoomTransform: null\n    };\n    this.uuid = `_${uuidv1()}`;\n    this.zoom = d3.zoom().on(\"zoom\", this.zoomFunction.bind(this));\n  }\n\n  componentDidMount() {\n    const svg = d3Select(this.svg);\n    svg.call(this.zoom);\n    document.addEventListener(\"keyup\", this.keyUp.bind(this));\n  }\n\n  zoomFunction() {\n    this.setState({\n      zoomTransform: d3.event.transform\n    });\n  }\n\n  keyUp(event) {\n    const keyCode = event.which || event.keyCode;\n\n    if (keyCode === 27) {\n      this.zoom.transform(d3Select(this.svg), d3.zoomIdentity);\n    }\n  }\n\n  render() {\n    const {\n      timeseriesData,\n      measuresData,\n      height,\n      width,\n      onClick,\n      measure\n    } = this.props;\n    const {\n      zoomTransform\n    } = this.state; // Margins.\n\n    const marginTop = 10;\n    const marginRight = 25;\n    const marginBottom = 25;\n    const marginLeft = 50; // Find min & max values.\n\n    let minX = Math.min(d3.min(timeseriesData, function (d) {\n      return d.date;\n    }), d3.min(measuresData, function (d) {\n      return d.date_implemented;\n    }));\n    let maxX = Math.max(d3.max(timeseriesData, function (d) {\n      return d.date;\n    }), d3.max(measuresData, function (d) {\n      return d.date_implemented;\n    }));\n    let minY = d3.min(timeseriesData, function (d) {\n      return d.value;\n    });\n    let maxY = d3.max(timeseriesData, function (d) {\n      return d.value;\n    });\n\n    if (!minX) {\n      minX = new Date(2020, 1, 1);\n    }\n\n    if (!maxX) {\n      maxX = new Date();\n    }\n\n    if (!minY) {\n      minY = 0;\n    }\n\n    if (!maxY) {\n      maxY = 1;\n    } // Build X & Y scale.\n\n\n    const xScale = d3.scaleTime().domain([minX, maxX]).range([marginLeft, width - marginRight]);\n    const yScale = d3.scaleLinear().domain([minY, maxY]).range([height - marginBottom, marginTop]); // Update zoom.\n\n    if (zoomTransform) {\n      xScale.domain(zoomTransform.rescaleX(xScale).domain());\n      yScale.domain(zoomTransform.rescaleY(yScale).domain());\n    } // Set grid & axis props.\n\n\n    const xProps = {\n      orient: 'Bottom',\n      scale: xScale,\n      translate: `translate(0, ${height - marginBottom})`,\n      tickSize: height - marginTop - marginBottom\n    };\n    const yProps = {\n      orient: 'Left',\n      scale: yScale,\n      translate: `translate(${marginLeft}, 0)`,\n      tickSize: width - marginLeft - marginRight\n    };\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      ref: el => {\n        this.svg = el;\n      },\n      style: {\n        height: `${height}px`,\n        width: `${width}px`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"defs\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: this.uuid,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      x: marginLeft,\n      y: marginTop,\n      width: width - marginLeft - marginRight,\n      height: height - marginTop - marginBottom,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 19\n      }\n    }))), /*#__PURE__*/React.createElement(Grid, Object.assign({}, yProps, {\n      color: \"#ddd\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(Grid, Object.assign({}, xProps, {\n      color: \"#ddd\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 5\n      }\n    })), /*#__PURE__*/React.createElement(Axis, Object.assign({}, xProps, {\n      color: \"#ddd\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 5\n      }\n    })), /*#__PURE__*/React.createElement(Axis, Object.assign({}, yProps, {\n      color: \"#ddd\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 5\n      }\n    })), /*#__PURE__*/React.createElement(\"g\", {\n      clipPath: `url(#${this.uuid})`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(LineChart, {\n      xScale: xScale,\n      yScale: yScale,\n      data: timeseriesData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 6\n      }\n    }), /*#__PURE__*/React.createElement(ImageChart, {\n      xScale: xScale,\n      data: measuresData,\n      height: height,\n      onClick: onClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 6\n      }\n    })));\n  }\n\n}\n\nexport default Chart;","map":{"version":3,"sources":["/Users/samuelvirgo/Documents/development/ditto/covid19_tracker_app/src/chart/chart.js"],"names":["React","d3","select","d3Select","uuidv1","Axis","Grid","LineChart","ImageChart","Chart","Component","constructor","props","state","zoomTransform","uuid","zoom","on","zoomFunction","bind","componentDidMount","svg","call","document","addEventListener","keyUp","setState","event","transform","keyCode","which","zoomIdentity","render","timeseriesData","measuresData","height","width","onClick","measure","marginTop","marginRight","marginBottom","marginLeft","minX","Math","min","d","date","date_implemented","maxX","max","minY","value","maxY","Date","xScale","scaleTime","domain","range","yScale","scaleLinear","rescaleX","rescaleY","xProps","orient","scale","translate","tickSize","yProps","el"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport { select as d3Select } from 'd3-selection';\nimport uuidv1 from \"uuid\";\n\nimport Axis from './axis.js';\nimport Grid from './grid.js';\nimport LineChart from './line.js';\nimport ImageChart from './image.js';\n\nclass Chart extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tzoomTransform: null,\n\t\t}\n\n\t\tthis.uuid = `_${uuidv1()}`;\n\t\tthis.zoom = d3.zoom().on(\"zoom\", this.zoomFunction.bind(this));\n\t}\n\n\tcomponentDidMount() {\n\t\tconst svg = d3Select(this.svg);\n\t\tsvg.call(this.zoom);\n\n\t\tdocument.addEventListener(\"keyup\", this.keyUp.bind(this));\n\t}\n\n\tzoomFunction() {\n\t\tthis.setState({\n\t\t\tzoomTransform: d3.event.transform,\n\t\t})\n\t}\n\n\tkeyUp(event) {\n\t\tconst keyCode = event.which || event.keyCode;\n\t\tif(keyCode === 27) {\n\t\t\tthis.zoom.transform(d3Select(this.svg), d3.zoomIdentity);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { \n\t\t\ttimeseriesData, \n\t\t\tmeasuresData, \n\t\t\theight, \n\t\t\twidth, \n\t\t\tonClick,\n\t\t\tmeasure,\n\t\t} = this.props;\n\n\t\tconst { zoomTransform } = this.state;\n\t\t\n\t\t// Margins.\n\t\tconst marginTop = 10;\n\t\tconst marginRight = 25; \n\t\tconst marginBottom = 25; \n\t\tconst marginLeft = 50;\n\n\t\t// Find min & max values.\n\t\tlet minX = Math.min(d3.min(timeseriesData, function(d) { return d.date; }), d3.min(measuresData, function(d) { return d.date_implemented; }))\n\t\tlet maxX = Math.max(d3.max(timeseriesData, function(d) { return d.date; }), d3.max(measuresData, function(d) { return d.date_implemented; }))\n\t\tlet minY = d3.min(timeseriesData, function(d) { return d.value; });\n\t\tlet maxY = d3.max(timeseriesData, function(d) { return d.value; });\n\n\t\tif(!minX) { minX = new Date(2020, 1, 1); }\n\t\tif(!maxX) { maxX = new Date(); }\n\t\tif(!minY) { minY = 0 }\n\t\tif(!maxY) { maxY = 1 }\n\n\t\t// Build X & Y scale.\n\t\tconst xScale = d3.scaleTime()\n\t\t\t.domain([minX, maxX])\n\t\t\t.range([marginLeft, width - marginRight]);\n\n\t\tconst yScale = d3.scaleLinear()\n\t\t\t.domain([minY, maxY])\n\t\t\t.range([height - marginBottom, marginTop]);\n\n\t\t// Update zoom.\n\t\tif(zoomTransform) {\n\t\t\txScale.domain(zoomTransform.rescaleX(xScale).domain());\n\t\t\tyScale.domain(zoomTransform.rescaleY(yScale).domain());\n\t\t}\n\n\t\t// Set grid & axis props.\n\t\tconst xProps = {\n\t\t\torient: 'Bottom',\n\t\t\tscale: xScale,\n\t\t\ttranslate: `translate(0, ${height - marginBottom})`,\n\t\t\ttickSize: height - marginTop - marginBottom,\n\t\t}\n\n\t\tconst yProps = {\n\t\t\torient: 'Left',\n\t\t\tscale: yScale,\n\t\t\ttranslate: `translate(${marginLeft}, 0)`,\n\t\t\ttickSize: width - marginLeft - marginRight,\n\t\t}\n\n\t\treturn (\n\t\t\t<svg ref={(el) => { this.svg = el; }} style={{height:`${height}px`, width:`${width}px`}}>\n\t\t\t\t<defs>\n\t\t            <clipPath id={this.uuid}>\n\t\t                <rect x={marginLeft} y={marginTop} width={width - marginLeft - marginRight} height={height - marginTop - marginBottom}/>\n\t\t            </clipPath>\n\t\t        </defs>\n\t        \t<Grid {...yProps} color={\"#ddd\"} />\n\t\t\t\t<Grid {...xProps} color={\"#ddd\"} />\n\t\t\t\t<Axis {...xProps} color={\"#ddd\"} />\n\t\t\t\t<Axis {...yProps} color={\"#ddd\"} />\n\t\t\t\t<g clipPath={`url(#${this.uuid})`}>\n\t\t\t\t\t<LineChart\n\t\t\t\t\t\txScale={xScale}\n\t\t\t\t\t\tyScale={yScale}\n\t\t\t\t\t\tdata={timeseriesData}\n\t\t\t\t\t/>\n\t\t\t\t\t<ImageChart\n\t\t\t\t\t\txScale={xScale}\n\t\t\t\t\t\tdata={measuresData}\n\t\t\t\t\t\theight={height}\n\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t);\n\t}\n}\n\nexport default Chart;"]},"metadata":{},"sourceType":"module"}